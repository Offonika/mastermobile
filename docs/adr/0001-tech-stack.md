# ADR-0001: Технологический стек

## Context
- MasterMobile выступает посредником между 1С, Bitrix24 и Walking Warehouse, требуя единого web-слоя и интеграций с системами хранения и очередей.
- Команда уже поддерживает инфраструктуру Python, FastAPI и Postgres, что уменьшает время выхода на рынок и стоимость сопровождения.
- CI/CD конвейер, шаблоны миграций и OpenAPI контракты привязаны к стеку Python 3.11, FastAPI, Postgres и Redis, поэтому отклонение от него приведёт к разрыву процессов.

## Decision
### Язык
- Backend на Python 3.11 с использованием FastAPI для асинхронного веб-слоя.
- Инструменты управления зависимостями и сборки — `poetry`/`uv` через `pyproject.toml` и Makefile.

### Данные
- Основное хранилище — PostgreSQL 16 с SQLAlchemy и Alembic для миграций.
- Схемы и миграции синхронизируются с документацией ER/DDL.

### Кэш/очереди
- Redis 7 используется для кэша конфигураций и фоновых очередей задач.
- Celery/Redis Queue подключаются по мере появления долгоживущих задач.

### Качество
- Статический анализ и форматирование: Ruff, Black.
- Проверка типов — MyPy, тесты — PyTest в связке с Docker Compose.

### Наблюдаемость
- Структурированное логирование через стандартный `logging` с JSON-форматом.
- Метрики и трейсы собираются через OpenTelemetry с экспортом в Prometheus/Grafana стек.

**Пересмотр решения** возможен, если:
- появляется потребность в языках/рантаймах с лучшей поддержкой высоконагруженных real-time сценариев;
- потребуется горизонтальное масштабирование, требующее брокера уровнем выше Redis (например, Kafka);
- корпоративные стандарты безопасности/наблюдаемости предписывают альтернативные инструменты.

## Consequences
- Существующие пайплайны CI и инфраструктурные скрипты можно использовать без доработок.
- Команда концентрируется на бизнес-логике, так как документация и шаблоны уже синхронизированы с выбранным стеком.
- Появляется необходимость поддерживать в актуальном состоянии шаблоны OpenTelemetry и мониторинг для всех сервисов.

## Status
Accepted
